
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Native API &#8212; UCLA Dataverse</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Metrics API" href="metrics.html" />
    <link rel="prev" title="Data Access API" href="dataaccess.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>








<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#dv-bs-navbar-details">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://dataverse.ucla.edu" id="dataverse-org-homepage-url">UCLA Dataverse</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->

       <div class="collapse navbar-collapse" id="dv-bs-navbar-details">
           <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a target="_blank" href="http://dataverse.org/about">About the Dataverse Project</a></li>
                        <li><a target="_blank" href="http://dataverse.org/add-data">Add Data</a></li>
                        <li><a target="_blank" href="http://dataverse.org/blog">Blog</a></li>
                        <li><a target="_blank" href="http://dataverse.org/presentations">Presentations</a></li>
                        <li><a target="_blank" href="http://dataverse.org/publications">Publications</a></li>
                    </ul>
                </li>
                <li>
                    <a target="_blank" href="http://dataverse.org/">
                        Community
                    </a>
                </li>
                <li>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Best Practices <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a target="_blank" href="http://dataverse.org/data-citation">Academic Credit</a></li>
                        <li><a target="_blank" href="">UCLA Dataverse Policies</a></li>
                        <li><a target="_blank" href="http://dataverse.org/data-management">Data Management</a></li>
                        <li><a target="_blank" href="http://dataverse.org/replication-dataset">Replication Dataset Guidelines</a></li>
                    </ul>
                </li>
                <li>
                    <a target="_blank" href="mailto:datascience+dvn@ucla.edu">
                        Contact
                    </a>
                </li>
            </ul>
       </div><!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../policy/index.html">UCLA Dataverse Policies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="sword.html">SWORD API</a></li>
<li class="toctree-l2"><a class="reference internal" href="search.html">Search API</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataaccess.html">Data Access API</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Native API</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">Metrics API</a></li>
<li class="toctree-l2"><a class="reference internal" href="client-libraries.html">Client Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="apps.html">Apps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../style/index.html">Style Guide</a></li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="native-api">
<h1>Native API<a class="headerlink" href="#native-api" title="Permalink to this headline">¶</a></h1>
<p>Dataverse 4 exposes most of its GUI functionality via a REST-based API. This section describes that functionality. Most API endpoints require an API token that can be passed as the <code class="docutils literal notranslate"><span class="pre">X-Dataverse-key</span></code> HTTP header or in the URL as the <code class="docutils literal notranslate"><span class="pre">key</span></code> query parameter.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><span class="label label-success pull-right">
  CORS
</span> Some API endpoint allow <a class="reference external" href="https://www.w3.org/TR/cors/">CORS</a> (cross-origin resource sharing), which makes them usable from scripts runing in web browsers. These endpoints are marked with a <em>CORS</em> badge.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Dataverse 4’s API is versioned at the URI - all API calls may include the version number like so: <code class="docutils literal notranslate"><span class="pre">http://server-address/api/v1/...</span></code>. Omitting the <code class="docutils literal notranslate"><span class="pre">v1</span></code> part would default to the latest API version (currently 1). When writing scripts/applications that will be used for a long time, make sure to specify the API version, so they don’t break when the API is upgraded.</p>
</div>
<div class="contents local topic" id="toctitle">
<p class="topic-title first">Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#dataverses" id="id14">Dataverses</a><ul>
<li><a class="reference internal" href="#create-a-dataverse" id="id15">Create a Dataverse</a></li>
<li><a class="reference internal" href="#view-a-dataverse" id="id16">View a Dataverse</a></li>
<li><a class="reference internal" href="#delete-a-dataverse" id="id17">Delete a Dataverse</a></li>
<li><a class="reference internal" href="#show-contents-of-a-dataverse" id="id18">Show Contents of a Dataverse</a></li>
<li><a class="reference internal" href="#list-roles-defined-in-a-dataverse" id="id19">List Roles Defined in a Dataverse</a></li>
<li><a class="reference internal" href="#list-facets-configured-for-a-dataverse" id="id20">List Facets Configured for a Dataverse</a></li>
<li><a class="reference internal" href="#set-facets-for-a-dataverse" id="id21">Set Facets for a Dataverse</a></li>
<li><a class="reference internal" href="#create-a-new-role-in-a-dataverse" id="id22">Create a New Role in a Dataverse</a></li>
<li><a class="reference internal" href="#list-role-assignments-in-a-dataverse" id="id23">List Role Assignments in a Dataverse</a></li>
<li><a class="reference internal" href="#assign-a-new-role-on-a-dataverse" id="id24">Assign a New Role on a Dataverse</a></li>
<li><a class="reference internal" href="#delete-role-assignment-from-a-dataverse" id="id25">Delete Role Assignment from a Dataverse</a></li>
<li><a class="reference internal" href="#list-metadata-blocks-defined-on-a-dataverse" id="id26">List Metadata Blocks Defined on a Dataverse</a></li>
<li><a class="reference internal" href="#define-metadata-blocks-for-a-dataverse" id="id27">Define Metadata Blocks for a Dataverse</a></li>
<li><a class="reference internal" href="#determine-if-a-dataverse-inherits-its-metadata-blocks-from-its-parent" id="id28">Determine if a Dataverse Inherits Its Metadata Blocks from Its Parent</a></li>
<li><a class="reference internal" href="#configure-a-dataverse-to-inherit-its-metadata-blocks-from-its-parent" id="id29">Configure a Dataverse to Inherit Its Metadata Blocks from Its Parent</a></li>
<li><a class="reference internal" href="#create-a-dataset-in-a-dataverse" id="id30">Create a Dataset in a Dataverse</a></li>
<li><a class="reference internal" href="#import-a-dataset-into-a-dataverse" id="id31">Import a Dataset into a Dataverse</a></li>
<li><a class="reference internal" href="#publish-a-dataverse" id="id32">Publish a Dataverse</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datasets" id="id33">Datasets</a><ul>
<li><a class="reference internal" href="#get-json-representation-of-a-dataset" id="id34">Get JSON Representation of a Dataset</a></li>
<li><a class="reference internal" href="#delete-dataset" id="id35">Delete Dataset</a></li>
<li><a class="reference internal" href="#list-versions-of-a-dataset" id="id36">List Versions of a Dataset</a></li>
<li><a class="reference internal" href="#get-version-of-a-dataset" id="id37">Get Version of a Dataset</a></li>
<li><a class="reference internal" href="#export-metadata-of-a-dataset-in-various-formats" id="id38">Export Metadata of a Dataset in Various Formats</a></li>
<li><a class="reference internal" href="#list-files-in-a-dataset" id="id39">List Files in a Dataset</a></li>
<li><a class="reference internal" href="#list-all-metadata-blocks-for-a-dataset" id="id40">List All Metadata Blocks for a Dataset</a></li>
<li><a class="reference internal" href="#list-single-metadata-block-for-a-dataset" id="id41">List Single Metadata Block for a Dataset</a></li>
<li><a class="reference internal" href="#update-metadata-for-a-dataset" id="id42">Update Metadata For a Dataset</a></li>
<li><a class="reference internal" href="#edit-dataset-metadata" id="id43">Edit Dataset Metadata</a></li>
<li><a class="reference internal" href="#delete-dataset-metadata" id="id44">Delete Dataset Metadata</a></li>
<li><a class="reference internal" href="#publish-a-dataset" id="id45">Publish a Dataset</a></li>
<li><a class="reference internal" href="#delete-dataset-draft" id="id46">Delete Dataset Draft</a></li>
<li><a class="reference internal" href="#set-citation-date-field-for-a-dataset" id="id47">Set Citation Date Field for a Dataset</a></li>
<li><a class="reference internal" href="#revert-citation-date-field-to-default-for-dataset" id="id48">Revert Citation Date Field to Default for Dataset</a></li>
<li><a class="reference internal" href="#list-role-assignments-for-a-dataset" id="id49">List Role Assignments for a Dataset</a></li>
<li><a class="reference internal" href="#create-a-private-url-for-a-dataset" id="id50">Create a Private URL for a Dataset</a></li>
<li><a class="reference internal" href="#get-the-private-url-for-a-dataset" id="id51">Get the Private URL for a Dataset</a></li>
<li><a class="reference internal" href="#delete-the-private-url-from-a-dataset" id="id52">Delete the Private URL from a Dataset</a></li>
<li><a class="reference internal" href="#add-a-file-to-a-dataset" id="id53">Add a File to a Dataset</a></li>
<li><a class="reference internal" href="#submit-a-dataset-for-review" id="id54">Submit a Dataset for Review</a></li>
<li><a class="reference internal" href="#return-a-dataset-to-author" id="id55">Return a Dataset to Author</a></li>
<li><a class="reference internal" href="#link-a-dataset" id="id56">Link a Dataset</a></li>
<li><a class="reference internal" href="#dataset-locks" id="id57">Dataset Locks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#files" id="id58">Files</a><ul>
<li><a class="reference internal" href="#adding-files" id="id59">Adding Files</a></li>
<li><a class="reference internal" href="#accessing-downloading-files" id="id60">Accessing (downloading) files</a></li>
<li><a class="reference internal" href="#restrict-files" id="id61">Restrict Files</a></li>
<li><a class="reference internal" href="#replacing-files" id="id62">Replacing Files</a></li>
<li><a class="reference internal" href="#uningest-a-file" id="id63">Uningest a File</a></li>
<li><a class="reference internal" href="#reingest-a-file" id="id64">Reingest a File</a></li>
<li><a class="reference internal" href="#provenance" id="id65">Provenance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#builtin-users" id="id66">Builtin Users</a><ul>
<li><a class="reference internal" href="#create-a-builtin-user" id="id67">Create a Builtin User</a></li>
</ul>
</li>
<li><a class="reference internal" href="#roles" id="id68">Roles</a><ul>
<li><a class="reference internal" href="#id1" id="id69">Create a New Role in a Dataverse</a></li>
<li><a class="reference internal" href="#show-role" id="id70">Show Role</a></li>
<li><a class="reference internal" href="#delete-role" id="id71">Delete Role</a></li>
</ul>
</li>
<li><a class="reference internal" href="#explicit-groups" id="id72">Explicit Groups</a><ul>
<li><a class="reference internal" href="#create-new-explicit-group" id="id73">Create New Explicit Group</a></li>
<li><a class="reference internal" href="#list-explicit-groups-in-a-dataverse" id="id74">List Explicit Groups in a Dataverse</a></li>
<li><a class="reference internal" href="#show-single-group-in-a-dataverse" id="id75">Show Single Group in a Dataverse</a></li>
<li><a class="reference internal" href="#update-group-in-a-dataverse" id="id76">Update Group in a Dataverse</a></li>
<li><a class="reference internal" href="#delete-group-from-a-dataverse" id="id77">Delete Group from a Dataverse</a></li>
<li><a class="reference internal" href="#add-multiple-role-assignees-to-an-explicit-group" id="id78">Add Multiple Role Assignees to an Explicit Group</a></li>
<li><a class="reference internal" href="#add-a-role-assignee-to-an-explicit-group" id="id79">Add a Role Assignee to an Explicit Group</a></li>
<li><a class="reference internal" href="#remove-a-role-assignee-from-an-explicit-group" id="id80">Remove a Role Assignee from an Explicit Group</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shibboleth-groups" id="id81">Shibboleth Groups</a></li>
<li><a class="reference internal" href="#info" id="id82">Info</a><ul>
<li><a class="reference internal" href="#show-dataverse-version-and-build-number" id="id83">Show Dataverse Version and Build Number</a></li>
<li><a class="reference internal" href="#show-dataverse-server-name" id="id84">Show Dataverse Server Name</a></li>
<li><a class="reference internal" href="#show-custom-popup-text-for-publishing-datasets" id="id85">Show Custom Popup Text for Publishing Datasets</a></li>
<li><a class="reference internal" href="#get-api-terms-of-use-url" id="id86">Get API Terms of Use URL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#metadata-blocks" id="id87">Metadata Blocks</a><ul>
<li><a class="reference internal" href="#show-info-about-all-metadata-blocks" id="id88">Show Info About All Metadata Blocks</a></li>
<li><a class="reference internal" href="#show-info-about-single-metadata-block" id="id89">Show Info About Single Metadata Block</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notifications" id="id90">Notifications</a><ul>
<li><a class="reference internal" href="#get-all-notifications-by-user" id="id91">Get All Notifications by User</a></li>
</ul>
</li>
<li><a class="reference internal" href="#admin" id="id92">Admin</a><ul>
<li><a class="reference internal" href="#list-all-database-settings" id="id93">List All Database Settings</a></li>
<li><a class="reference internal" href="#configure-database-setting" id="id94">Configure Database Setting</a></li>
<li><a class="reference internal" href="#get-single-database-setting" id="id95">Get Single Database Setting</a></li>
<li><a class="reference internal" href="#delete-database-setting" id="id96">Delete Database Setting</a></li>
<li><a class="reference internal" href="#list-authentication-provider-factories" id="id97">List Authentication Provider Factories</a></li>
<li><a class="reference internal" href="#list-authentication-providers" id="id98">List Authentication Providers</a></li>
<li><a class="reference internal" href="#add-authentication-provider" id="id99">Add Authentication Provider</a></li>
<li><a class="reference internal" href="#show-authentication-provider" id="id100">Show Authentication Provider</a></li>
<li><a class="reference internal" href="#enable-or-disable-an-authentication-provider" id="id101">Enable or Disable an Authentication Provider</a></li>
<li><a class="reference internal" href="#check-if-an-authentication-provider-is-enabled" id="id102">Check If an Authentication Provider is Enabled</a></li>
<li><a class="reference internal" href="#delete-an-authentication-provider" id="id103">Delete an Authentication Provider</a></li>
<li><a class="reference internal" href="#list-global-roles" id="id104">List Global Roles</a></li>
<li><a class="reference internal" href="#create-global-role" id="id105">Create Global Role</a></li>
<li><a class="reference internal" href="#list-users" id="id106">List Users</a></li>
<li><a class="reference internal" href="#list-single-user" id="id107">List Single User</a></li>
<li><a class="reference internal" href="#make-user-a-superuser" id="id108">Make User a SuperUser</a></li>
<li><a class="reference internal" href="#list-role-assignments-of-a-role-assignee" id="id109">List Role Assignments of a Role Assignee</a></li>
<li><a class="reference internal" href="#list-permissions-a-user-has-on-a-dataverse-or-dataset" id="id110">List Permissions a User Has on a Dataverse or Dataset</a></li>
<li><a class="reference internal" href="#show-role-assignee" id="id111">Show Role Assignee</a></li>
<li><a class="reference internal" href="#saved-search" id="id112">Saved Search</a></li>
<li><a class="reference internal" href="#dataset-integrity" id="id113">Dataset Integrity</a></li>
<li><a class="reference internal" href="#workflows" id="id114">Workflows</a></li>
<li><a class="reference internal" href="#metrics" id="id115">Metrics</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="dataverses">
<h2><a class="toc-backref" href="#id14">Dataverses</a><a class="headerlink" href="#dataverses" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-a-dataverse">
<h3><a class="toc-backref" href="#id15">Create a Dataverse</a><a class="headerlink" href="#create-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Generates a new dataverse under <code class="docutils literal notranslate"><span class="pre">$id</span></code>. Expects a JSON content describing the dataverse, as in the example below.
If <code class="docutils literal notranslate"><span class="pre">$id</span></code> is omitted, a root dataverse is created. <code class="docutils literal notranslate"><span class="pre">$id</span></code> can either be a dataverse id (long) or a dataverse alias (more robust).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/dataverses/$id?key=$apiKey
</pre></div>
</div>
<p>Download the <a class="reference download internal" href="../_downloads/dataverse-complete.json" download=""><code class="xref download docutils literal notranslate"><span class="pre">JSON</span> <span class="pre">example</span></code></a> file and modified to create dataverses to suit your needs. The fields <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">alias</span></code>, and <code class="docutils literal notranslate"><span class="pre">dataverseContacts</span></code> are required. The controlled vocabulary for <code class="docutils literal notranslate"><span class="pre">dataverseType</span></code> is</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">DEPARTMENT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">JOURNALS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">LABORATORY</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ORGANIZATIONS_INSTITUTIONS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">RESEARCHERS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">RESEARCH_GROUP</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">RESEARCH_PROJECTS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">TEACHING_COURSES</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">UNCATEGORIZED</span></code></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Scientific Research&quot;</span><span class="p">,</span>
  <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;science&quot;</span><span class="p">,</span>
  <span class="s2">&quot;dataverseContacts&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;contactEmail&quot;</span><span class="p">:</span> <span class="s2">&quot;pi@example.edu&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;contactEmail&quot;</span><span class="p">:</span> <span class="s2">&quot;student@example.edu&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;affiliation&quot;</span><span class="p">:</span> <span class="s2">&quot;Scientific Research University&quot;</span><span class="p">,</span>
  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;We do all the science.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;dataverseType&quot;</span><span class="p">:</span> <span class="s2">&quot;LABORATORY&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="view-a-dataverse">
<h3><a class="toc-backref" href="#id16">View a Dataverse</a><a class="headerlink" href="#view-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> View data about the dataverse identified by <code class="docutils literal notranslate"><span class="pre">$id</span></code>. <code class="docutils literal notranslate"><span class="pre">$id</span></code> can be the id number of the dataverse, its alias, or the special value <code class="docutils literal notranslate"><span class="pre">:root</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id
</pre></div>
</div>
</div>
<div class="section" id="delete-a-dataverse">
<h3><a class="toc-backref" href="#id17">Delete a Dataverse</a><a class="headerlink" href="#delete-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Deletes the dataverse whose ID is given:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/dataverses/$id?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="show-contents-of-a-dataverse">
<h3><a class="toc-backref" href="#id18">Show Contents of a Dataverse</a><a class="headerlink" href="#show-contents-of-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Lists all the DvObjects under dataverse <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id/contents
</pre></div>
</div>
</div>
<div class="section" id="list-roles-defined-in-a-dataverse">
<h3><a class="toc-backref" href="#id19">List Roles Defined in a Dataverse</a><a class="headerlink" href="#list-roles-defined-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>All the roles defined directly in the dataverse identified by <code class="docutils literal notranslate"><span class="pre">id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id/roles?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-facets-configured-for-a-dataverse">
<h3><a class="toc-backref" href="#id20">List Facets Configured for a Dataverse</a><a class="headerlink" href="#list-facets-configured-for-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> List all the facets for a given dataverse <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id/facets?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="set-facets-for-a-dataverse">
<h3><a class="toc-backref" href="#id21">Set Facets for a Dataverse</a><a class="headerlink" href="#set-facets-for-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Assign search facets for a given dataverse with alias <code class="docutils literal notranslate"><span class="pre">$alias</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;X-Dataverse-key:</span> <span class="pre">$apiKey&quot;</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">http://$server/api/dataverses/$alias/facets</span> <span class="pre">--upload-file</span> <span class="pre">facets.json</span></code></p>
<p>Where <code class="docutils literal notranslate"><span class="pre">facets.json</span></code> contains a JSON encoded list of metadata keys (e.g. <code class="docutils literal notranslate"><span class="pre">[&quot;authorName&quot;,&quot;authorAffiliation&quot;]</span></code>).</p>
</div>
<div class="section" id="create-a-new-role-in-a-dataverse">
<h3><a class="toc-backref" href="#id22">Create a New Role in a Dataverse</a><a class="headerlink" href="#create-a-new-role-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Creates a new role under dataverse <code class="docutils literal notranslate"><span class="pre">id</span></code>. Needs a json file with the role description:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/dataverses/$id/roles?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-role-assignments-in-a-dataverse">
<h3><a class="toc-backref" href="#id23">List Role Assignments in a Dataverse</a><a class="headerlink" href="#list-role-assignments-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>List all the role assignments at the given dataverse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id/assignments?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="assign-a-new-role-on-a-dataverse">
<h3><a class="toc-backref" href="#id24">Assign a New Role on a Dataverse</a><a class="headerlink" href="#assign-a-new-role-on-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Assigns a new role, based on the POSTed JSON.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/dataverses/$id/assignments?key=$apiKey
</pre></div>
</div>
<p>POSTed JSON example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="s2">&quot;@uma&quot;</span><span class="p">,</span>
  <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;curator&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-role-assignment-from-a-dataverse">
<h3><a class="toc-backref" href="#id25">Delete Role Assignment from a Dataverse</a><a class="headerlink" href="#delete-role-assignment-from-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Delete the assignment whose id is <code class="docutils literal notranslate"><span class="pre">$id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/dataverses/$id/assignments/$id?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-metadata-blocks-defined-on-a-dataverse">
<h3><a class="toc-backref" href="#id26">List Metadata Blocks Defined on a Dataverse</a><a class="headerlink" href="#list-metadata-blocks-defined-on-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Get the metadata blocks defined on the passed dataverse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id/metadatablocks?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="define-metadata-blocks-for-a-dataverse">
<h3><a class="toc-backref" href="#id27">Define Metadata Blocks for a Dataverse</a><a class="headerlink" href="#define-metadata-blocks-for-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Sets the metadata blocks of the dataverse. Makes the dataverse a metadatablock root. The query body is a JSON array with a list of metadatablocks identifiers (either id or name).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/dataverses/$id/metadatablocks?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="determine-if-a-dataverse-inherits-its-metadata-blocks-from-its-parent">
<h3><a class="toc-backref" href="#id28">Determine if a Dataverse Inherits Its Metadata Blocks from Its Parent</a><a class="headerlink" href="#determine-if-a-dataverse-inherits-its-metadata-blocks-from-its-parent" title="Permalink to this headline">¶</a></h3>
<p>Get whether the dataverse is a metadata block root, or does it uses its parent blocks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/dataverses/$id/metadatablocks/isRoot?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="configure-a-dataverse-to-inherit-its-metadata-blocks-from-its-parent">
<h3><a class="toc-backref" href="#id29">Configure a Dataverse to Inherit Its Metadata Blocks from Its Parent</a><a class="headerlink" href="#configure-a-dataverse-to-inherit-its-metadata-blocks-from-its-parent" title="Permalink to this headline">¶</a></h3>
<p>Set whether the dataverse is a metadata block root, or does it uses its parent blocks. Possible
values are <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span></code> (both are valid JSON expressions).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/dataverses/$id/metadatablocks/isRoot?key=$apiKey
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Previous endpoints <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">http://$SERVER/api/dataverses/$id/metadatablocks/:isRoot?key=$apiKey</span></code> and <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">http://$SERVER/api/dataverses/$id/metadatablocks/:isRoot?key=$apiKey</span></code> are deprecated, but supported.</p>
</div>
</div>
<div class="section" id="create-a-dataset-in-a-dataverse">
<span id="create-dataset-command"></span><h3><a class="toc-backref" href="#id30">Create a Dataset in a Dataverse</a><a class="headerlink" href="#create-a-dataset-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>To create a dataset, you must create a JSON file containing all the metadata you want such as in this example file: <code class="xref download docutils literal notranslate"><span class="pre">dataset-finch1.json</span></code>. Then, you must decide which dataverse to create the dataset in and target that datavese with either the “alias” of the dataverse (e.g. “root” or the database id of the dataverse (e.g. “1”). The initial version state will be set to <code class="docutils literal notranslate"><span class="pre">DRAFT</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X POST $SERVER_URL/api/dataverses/$DV_ALIAS/datasets --upload-file dataset-finch1.json
</pre></div>
</div>
</div>
<div class="section" id="import-a-dataset-into-a-dataverse">
<h3><a class="toc-backref" href="#id31">Import a Dataset into a Dataverse</a><a class="headerlink" href="#import-a-dataset-into-a-dataverse" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This action requires a Dataverse account with super-user permissions.</p>
</div>
<p>To import a dataset with an existing persistent identifier (PID), the dataset’s metadata should be prepared in Dataverse’s native JSON format. The PID is provided as a parameter at the URL. The following line imports a dataset with the PID <code class="docutils literal notranslate"><span class="pre">PERSISTENT_IDENTIFIER</span></code> to Dataverse, and then releases it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X POST $SERVER_URL/api/dataverses/$DV_ALIAS/datasets/:import?pid=$PERSISTENT_IDENTIFIER&amp;release=yes --upload-file dataset.json
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pid</span></code> parameter holds a persistent identifier (such as a DOI or Handle). The import will fail if no PID is provided, or if the provided PID fails validation.</p>
<p>The optional <code class="docutils literal notranslate"><span class="pre">release</span></code> parameter tells Dataverse to immediately publish the dataset. If the parameter is changed to <code class="docutils literal notranslate"><span class="pre">no</span></code>, the imported dataset will remain in <code class="docutils literal notranslate"><span class="pre">DRAFT</span></code> status.</p>
<p>The JSON format is the same as that supported by the native API’s <a class="reference internal" href="#create-dataset-command"><span class="std std-ref">create dataset command</span></a>, although it also allows packages.  For example:</p>
<p>Before calling the API, make sure the data files referenced by the <code class="docutils literal notranslate"><span class="pre">POST</span></code>ed JSON are placed in the dataset directory with filenames matching their specified storage identifiers. In installations using POSIX storage, these files must be made readable by GlassFish.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If possible, it’s best to avoid spaces and special characters in the storage identifier in order to avoid potential portability problems. The storage identifier corresponds with the filesystem name (or bucket identifier) of the data file, so these characters may cause unpredictability with filesystem tools.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>This API does not cover staging files (with correct contents, checksums, sizes, etc.) in the corresponding places in the Dataverse filestore.</li>
<li>This API endpoint does not support importing <em>files’</em> persistent identifiers.</li>
<li>A Dataverse server can import datasets with a valid PID that uses a different protocol or authority than said server is configured for. However, the server will not update the PID metadata on subsequent update and publish actions.</li>
</ul>
</div>
</div>
<div class="section" id="publish-a-dataverse">
<h3><a class="toc-backref" href="#id32">Publish a Dataverse</a><a class="headerlink" href="#publish-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Publish the Dataverse pointed by <code class="docutils literal notranslate"><span class="pre">identifier</span></code>, which can either by the dataverse alias or its numerical id.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/dataverses/$identifier/actions/:publish?key=$apiKey
</pre></div>
</div>
</div>
</div>
<div class="section" id="datasets">
<h2><a class="toc-backref" href="#id33">Datasets</a><a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h2>
<p><strong>Note</strong> Creation of new datasets is done with a <code class="docutils literal notranslate"><span class="pre">POST</span></code> onto dataverses. See <a class="reference internal" href="#dataverses">Dataverses</a> section.</p>
<p><strong>Note</strong> In all commands below, dataset versions can be referred to as:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">:draft</span></code>  the draft version, if any</li>
<li><code class="docutils literal notranslate"><span class="pre">:latest</span></code> either a draft (if exists) or the latest published version.</li>
<li><code class="docutils literal notranslate"><span class="pre">:latest-published</span></code> the latest published version</li>
<li><code class="docutils literal notranslate"><span class="pre">x.y</span></code> a specific version, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is the major version number and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the minor version number.</li>
<li><code class="docutils literal notranslate"><span class="pre">x</span></code> same as <code class="docutils literal notranslate"><span class="pre">x.0</span></code></li>
</ul>
<div class="section" id="get-json-representation-of-a-dataset">
<h3><a class="toc-backref" href="#id34">Get JSON Representation of a Dataset</a><a class="headerlink" href="#get-json-representation-of-a-dataset" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Datasets can be accessed using persistent identifiers. This is done by passing the constant <code class="docutils literal notranslate"><span class="pre">:persistentId</span></code> where the numeric id of the dataset is expected, and then passing the actual persistent id as a query parameter with the name <code class="docutils literal notranslate"><span class="pre">persistentId</span></code>.</p>
<p>Example: Getting the dataset whose DOI is <em>10.5072/FK2/J8SJZB</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/:persistentId/?persistentId=doi:10.5072/FK2/J8SJZB
</pre></div>
</div>
<p>Getting its draft version:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/:persistentId/versions/:draft?persistentId=doi:10.5072/FK2/J8SJZB
</pre></div>
</div>
</div>
<p><span class="label label-success pull-right">
  CORS
</span> Show the dataset whose id is passed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="delete-dataset">
<h3><a class="toc-backref" href="#id35">Delete Dataset</a><a class="headerlink" href="#delete-dataset" title="Permalink to this headline">¶</a></h3>
<p>Delete the dataset whose id is passed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/datasets/$id?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-versions-of-a-dataset">
<h3><a class="toc-backref" href="#id36">List Versions of a Dataset</a><a class="headerlink" href="#list-versions-of-a-dataset" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> List versions of the dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/versions?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="get-version-of-a-dataset">
<h3><a class="toc-backref" href="#id37">Get Version of a Dataset</a><a class="headerlink" href="#get-version-of-a-dataset" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Show a version of the dataset. The Dataset also include any metadata blocks the data might have:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/versions/$versionNumber?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="export-metadata-of-a-dataset-in-various-formats">
<h3><a class="toc-backref" href="#id38">Export Metadata of a Dataset in Various Formats</a><a class="headerlink" href="#export-metadata-of-a-dataset-in-various-formats" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Export the metadata of the current published version of a dataset in various formats see Note below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/export?exporter=ddi&amp;persistentId=$persistentId
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Supported exporters (export formats) are <code class="docutils literal notranslate"><span class="pre">ddi</span></code>, <code class="docutils literal notranslate"><span class="pre">oai_ddi</span></code>, <code class="docutils literal notranslate"><span class="pre">dcterms</span></code>, <code class="docutils literal notranslate"><span class="pre">oai_dc</span></code>, <code class="docutils literal notranslate"><span class="pre">schema.org</span></code> , and <code class="docutils literal notranslate"><span class="pre">dataverse_json</span></code>.</p>
</div>
</div>
<div class="section" id="list-files-in-a-dataset">
<h3><a class="toc-backref" href="#id39">List Files in a Dataset</a><a class="headerlink" href="#list-files-in-a-dataset" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Lists all the file metadata, for the given dataset and version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/versions/$versionId/files?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-all-metadata-blocks-for-a-dataset">
<h3><a class="toc-backref" href="#id40">List All Metadata Blocks for a Dataset</a><a class="headerlink" href="#list-all-metadata-blocks-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Lists all the metadata blocks and their content, for the given dataset and version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/versions/$versionId/metadata?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-single-metadata-block-for-a-dataset">
<h3><a class="toc-backref" href="#id41">List Single Metadata Block for a Dataset</a><a class="headerlink" href="#list-single-metadata-block-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Lists the metadata block block named <cite>blockname</cite>, for the given dataset and version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/versions/$versionId/metadata/$blockname?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="update-metadata-for-a-dataset">
<h3><a class="toc-backref" href="#id42">Update Metadata For a Dataset</a><a class="headerlink" href="#update-metadata-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Updates the metadata for a dataset. If a draft of the dataset already exists, the metadata of that draft is overwritten; otherwise, a new draft is created with this metadata.</p>
<p>You must download a JSON representation of the dataset, edit the JSON you download, and then send the updated JSON to the Dataverse server.</p>
<p>For example, after making your edits, your JSON file might look like <a class="reference download internal" href="../_downloads/dataset-update-metadata.json" download=""><code class="xref download docutils literal notranslate"><span class="pre">dataset-update-metadata.json</span></code></a> which you would send to Dataverse like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X PUT $SERVER_URL/api/datasets/:persistentId/versions/:draft?persistentId=$PID --upload-file dataset-update-metadata.json
</pre></div>
</div>
<p>Note that in the example JSON file above, there is a single JSON object with <code class="docutils literal notranslate"><span class="pre">metadataBlocks</span></code> as a key. When you download a representation of your dataset in JSON format, the <code class="docutils literal notranslate"><span class="pre">metadataBlocks</span></code> object you need is nested inside another object called <code class="docutils literal notranslate"><span class="pre">json</span></code>. To extract just the <code class="docutils literal notranslate"><span class="pre">metadataBlocks</span></code> key when downloading a JSON representation, you can use a tool such as <code class="docutils literal notranslate"><span class="pre">jq</span></code> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; $SERVER_URL/api/datasets/:persistentId/versions/:latest?persistentId=$PID | jq &#39;.data | {metadataBlocks: .metadataBlocks}&#39; &gt; dataset-update-metadata.json
</pre></div>
</div>
<p>Now that the resulting JSON file only contains the <code class="docutils literal notranslate"><span class="pre">metadataBlocks</span></code> key, you can edit the JSON such as with <code class="docutils literal notranslate"><span class="pre">vi</span></code> in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="n">dataset</span><span class="o">-</span><span class="n">update</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Now that you’ve made edits to the metadata in your JSON file, you can send it to Dataverse as described above.</p>
</div>
<div class="section" id="edit-dataset-metadata">
<h3><a class="toc-backref" href="#id43">Edit Dataset Metadata</a><a class="headerlink" href="#edit-dataset-metadata" title="Permalink to this headline">¶</a></h3>
<p>Alternatively to replacing an entire dataset version with its JSON representation you may add data to dataset fields that are blank or accept multiple values with the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X PUT $SERVER_URL/api/datasets/:persistentId/editMetadata/?persistentId=$PID --upload-file dataset-add-metadata.json
</pre></div>
</div>
<p>You may also replace existing metadata in dataset fields with the following (adding the parameter replace=true)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X PUT $SERVER_URL/api/datasets/:persistentId/editMetadata?persistentId=$PID&amp;replace=true --upload-file dataset-update-metadata.json
</pre></div>
</div>
<p>For these edits your JSON file need only include those dataset fields which you would like to edit. A sample JSON file may be downloaded here: <a class="reference download internal" href="../_downloads/dataset-edit-metadata-sample.json" download=""><code class="xref download docutils literal notranslate"><span class="pre">dataset-edit-metadata-sample.json</span></code></a></p>
</div>
<div class="section" id="delete-dataset-metadata">
<h3><a class="toc-backref" href="#id44">Delete Dataset Metadata</a><a class="headerlink" href="#delete-dataset-metadata" title="Permalink to this headline">¶</a></h3>
<p>You may delete some of the metadata of a dataset version by supplying a file with a JSON representation of dataset fields that you would like to delete with the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X PUT $SERVER_URL/api/datasets/:persistentId/deleteMetadata/?persistentId=$PID --upload-file dataset-delete-author-metadata.json
</pre></div>
</div>
<p>For these deletes your JSON file must include an exact match of those dataset fields which you would like to delete. A sample JSON file may be downloaded here: <a class="reference download internal" href="../_downloads/dataset-delete-author-metadata.json" download=""><code class="xref download docutils literal notranslate"><span class="pre">dataset-delete-author-metadata.json</span></code></a></p>
</div>
<div class="section" id="publish-a-dataset">
<h3><a class="toc-backref" href="#id45">Publish a Dataset</a><a class="headerlink" href="#publish-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Publishes the dataset whose id is passed. If this is the first version of the dataset, its version number will be set to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>. Otherwise, the new dataset version number is determined by the most recent version number and the <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter. Passing <code class="docutils literal notranslate"><span class="pre">type=minor</span></code> increases the minor version number (2.3 is updated to 2.4). Passing <code class="docutils literal notranslate"><span class="pre">type=major</span></code> increases the major version number (2.3 is updated to 3.0).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/datasets/$id/actions/:publish?type=$type&amp;key=$apiKey
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">POST should be used to publish a dataset. GET is supported for backward compatibility but is deprecated and may be removed: <a class="reference external" href="https://github.com/IQSS/dataverse/issues/2431">https://github.com/IQSS/dataverse/issues/2431</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When there are no default workflows, a successful publication process will result in <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code> response. When there are workflows, it is impossible for Dataverse to know
how long they are going to take and whether they will succeed or not (recall that some stages might require human intervention). Thus,
a <code class="docutils literal notranslate"><span class="pre">202</span> <span class="pre">ACCEPTED</span></code> is returned immediately. To know whether the publication process succeeded or not, the client code has to check the status of the dataset periodically,
or perform some push request in the post-publish workflow.</p>
</div>
</div>
<div class="section" id="delete-dataset-draft">
<h3><a class="toc-backref" href="#id46">Delete Dataset Draft</a><a class="headerlink" href="#delete-dataset-draft" title="Permalink to this headline">¶</a></h3>
<p>Deletes the draft version of dataset <code class="docutils literal notranslate"><span class="pre">$id</span></code>. Only the draft version can be deleted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/datasets/$id/versions/:draft?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="set-citation-date-field-for-a-dataset">
<h3><a class="toc-backref" href="#id47">Set Citation Date Field for a Dataset</a><a class="headerlink" href="#set-citation-date-field-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Sets the dataset field type to be used as the citation date for the given dataset (if the dataset does not include the dataset field type, the default logic is used). The name of the dataset field type should be sent in the body of the reqeust.
To revert to the default logic, use <code class="docutils literal notranslate"><span class="pre">:publicationDate</span></code> as the <code class="docutils literal notranslate"><span class="pre">$datasetFieldTypeName</span></code>.
Note that the dataset field used has to be a date field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/datasets/$id/citationdate?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="revert-citation-date-field-to-default-for-dataset">
<h3><a class="toc-backref" href="#id48">Revert Citation Date Field to Default for Dataset</a><a class="headerlink" href="#revert-citation-date-field-to-default-for-dataset" title="Permalink to this headline">¶</a></h3>
<p>Restores the default logic of the field type to be used as the citation date. Same as <code class="docutils literal notranslate"><span class="pre">PUT</span></code> with <code class="docutils literal notranslate"><span class="pre">:publicationDate</span></code> body:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/datasets/$id/citationdate?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="list-role-assignments-for-a-dataset">
<h3><a class="toc-backref" href="#id49">List Role Assignments for a Dataset</a><a class="headerlink" href="#list-role-assignments-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>List all the role assignments at the given dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/assignments?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="create-a-private-url-for-a-dataset">
<h3><a class="toc-backref" href="#id50">Create a Private URL for a Dataset</a><a class="headerlink" href="#create-a-private-url-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Create a Private URL (must be able to manage dataset permissions):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/datasets/$id/privateUrl?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="get-the-private-url-for-a-dataset">
<h3><a class="toc-backref" href="#id51">Get the Private URL for a Dataset</a><a class="headerlink" href="#get-the-private-url-for-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Get a Private URL from a dataset (if available):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/datasets/$id/privateUrl?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="delete-the-private-url-from-a-dataset">
<h3><a class="toc-backref" href="#id52">Delete the Private URL from a Dataset</a><a class="headerlink" href="#delete-the-private-url-from-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Delete a Private URL from a dataset (if it exists):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/datasets/$id/privateUrl?key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="add-a-file-to-a-dataset">
<h3><a class="toc-backref" href="#id53">Add a File to a Dataset</a><a class="headerlink" href="#add-a-file-to-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Add a file to an existing Dataset. Description and tags are optional:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/datasets/$id/add?key=$apiKey
</pre></div>
</div>
<p>A more detailed “add” example using curl:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Dataverse-key:$API_TOKEN&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">F</span> <span class="s1">&#39;file=@data.tsv&#39;</span> <span class="o">-</span><span class="n">F</span> <span class="s1">&#39;jsonData={&quot;description&quot;:&quot;My description.&quot;,&quot;categories&quot;:[&quot;Data&quot;], &quot;restrict&quot;:&quot;true&quot;}&#39;</span> <span class="s2">&quot;https://example.dataverse.edu/api/datasets/:persistentId/add?persistentId=$PERSISTENT_ID&quot;</span>
</pre></div>
</div>
<p>Example python code to add a file. This may be run by changing these parameters in the sample code:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dataverse_server</span></code> - e.g. <a class="reference external" href="https://demo.dataverse.org">https://demo.dataverse.org</a></li>
<li><code class="docutils literal notranslate"><span class="pre">api_key</span></code> - See the top of this document for a description</li>
<li><code class="docutils literal notranslate"><span class="pre">persistentId</span></code> - Example: <code class="docutils literal notranslate"><span class="pre">doi:10.5072/FK2/6XACVA</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dataset_id</span></code> - Database id of the dataset</li>
</ul>
<p>In practice, you only need one the <code class="docutils literal notranslate"><span class="pre">dataset_id</span></code> or the <code class="docutils literal notranslate"><span class="pre">persistentId</span></code>. The example below shows both uses.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>  <span class="c1"># http://docs.python-requests.org/en/master/</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Update the 4 params below to run this code</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">dataverse_server</span> <span class="o">=</span> <span class="s1">&#39;https://your dataverse server&#39;</span> <span class="c1"># no trailing slash</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;api key&#39;</span>
<span class="n">dataset_id</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># database id of the dataset</span>
<span class="n">persistentId</span> <span class="o">=</span> <span class="s1">&#39;doi:10.5072/FK2/6XACVA&#39;</span> <span class="c1"># doi or hdl of the dataset</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Prepare &quot;file&quot;</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">file_content</span> <span class="o">=</span> <span class="s1">&#39;content: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;sample_file.txt&#39;</span><span class="p">,</span> <span class="n">file_content</span><span class="p">)}</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Using a &quot;jsonData&quot; parameter, add optional description + file tags</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Blue skies!&#39;</span><span class="p">,</span>
            <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Lily&#39;</span><span class="p">,</span> <span class="s1">&#39;Rosemary&#39;</span><span class="p">,</span> <span class="s1">&#39;Jack of Hearts&#39;</span><span class="p">])</span>

<span class="n">params_as_json_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">jsonData</span><span class="o">=</span><span class="n">params_as_json_string</span><span class="p">)</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Add file using the Dataset&#39;s id</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">url_dataset_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/api/datasets/</span><span class="si">%s</span><span class="s1">/add?key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dataverse_server</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">)</span>

<span class="c1"># -------------------</span>
<span class="c1"># Make the request</span>
<span class="c1"># -------------------</span>
<span class="k">print</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">40</span>
<span class="k">print</span> <span class="s1">&#39;making request: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">url_dataset_id</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url_dataset_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>

<span class="c1"># -------------------</span>
<span class="c1"># Print the response</span>
<span class="c1"># -------------------</span>
<span class="k">print</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">40</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Add file using the Dataset&#39;s persistentId (e.g. doi, hdl, etc)</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">url_persistent_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/api/datasets/:persistentId/add?persistentId=</span><span class="si">%s</span><span class="s1">&amp;key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dataverse_server</span><span class="p">,</span> <span class="n">persistentId</span><span class="p">,</span> <span class="n">api_key</span><span class="p">)</span>

<span class="c1"># -------------------</span>
<span class="c1"># Update the file content to avoid a duplicate file error</span>
<span class="c1"># -------------------</span>
<span class="n">file_content</span> <span class="o">=</span> <span class="s1">&#39;content2: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;sample_file2.txt&#39;</span><span class="p">,</span> <span class="n">file_content</span><span class="p">)}</span>


<span class="c1"># -------------------</span>
<span class="c1"># Make the request</span>
<span class="c1"># -------------------</span>
<span class="k">print</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">40</span>
<span class="k">print</span> <span class="s1">&#39;making request: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">url_persistent_id</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url_persistent_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>

<span class="c1"># -------------------</span>
<span class="c1"># Print the response</span>
<span class="c1"># -------------------</span>
<span class="k">print</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">40</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
<div class="section" id="submit-a-dataset-for-review">
<h3><a class="toc-backref" href="#id54">Submit a Dataset for Review</a><a class="headerlink" href="#submit-a-dataset-for-review" title="Permalink to this headline">¶</a></h3>
<p>When dataset authors do not have permission to publish directly, they can click the “Submit for Review” button in the web interface (see <a class="reference internal" href="../user/dataset-management.html"><span class="doc">Dataset + File Management</span></a>), or perform the equivalent operation via API:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Dataverse-key: $API_TOKEN&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="s2">&quot;$SERVER_URL/api/datasets/:persistentId/submitForReview?persistentId=$DOI_OR_HANDLE_OF_DATASET&quot;</span>
</pre></div>
</div>
<p>The people who need to review the dataset (often curators or journal editors) can check their notifications periodically via API to see if any new datasets have been submitted for review and need their attention. See the <a class="reference internal" href="#notifications"><span class="std std-ref">Notifications</span></a> section for details. Alternatively, these curators can simply check their email or notifications to know when datasets have been submitted (or resubmitted) for review.</p>
</div>
<div class="section" id="return-a-dataset-to-author">
<h3><a class="toc-backref" href="#id55">Return a Dataset to Author</a><a class="headerlink" href="#return-a-dataset-to-author" title="Permalink to this headline">¶</a></h3>
<p>After the curators or journal editors have reviewed a dataset that has been submitted for review (see “Submit for Review”, above) they can either choose to publish the dataset (see the <code class="docutils literal notranslate"><span class="pre">:publish</span></code> “action” above) or return the dataset to its authors. In the web interface there is a “Return to Author” button (see <a class="reference internal" href="../user/dataset-management.html"><span class="doc">Dataset + File Management</span></a>), but the interface does not provide a way to explain <strong>why</strong> the dataset is being returned. There is a way to do this outside of this interface, however. Instead of clicking the “Return to Author” button in the UI, a curator can write a “reason for return” into the database via API.</p>
<p>Here’s how curators can send a “reason for return” to the dataset authors. First, the curator creates a JSON file that contains the reason for return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;reasonForReturn&quot;</span><span class="p">:</span> <span class="s2">&quot;You forgot to upload any files.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the example below, the curator has saved the JSON file as <a class="reference download internal" href="../_downloads/reason-for-return.json" download=""><code class="xref download docutils literal notranslate"><span class="pre">reason-for-return.json</span></code></a> in their current working directory. Then, the curator sends this JSON file to the <code class="docutils literal notranslate"><span class="pre">returnToAuthor</span></code> API endpoint like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type:application/json&quot;</span> <span class="o">-</span><span class="n">d</span> <span class="nd">@reason</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="k">return</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Dataverse-key: $API_TOKEN&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="s2">&quot;$SERVER_URL/api/datasets/:persistentId/returnToAuthor?persistentId=$DOI_OR_HANDLE_OF_DATASET&quot;</span>
</pre></div>
</div>
<p>The review process can sometimes resemble a tennis match, with the authors submitting and resubmitting the dataset over and over until the curators are satisfied. Each time the curators send a “reason for return” via API, that reason is persisted into the database, stored at the dataset version level.</p>
</div>
<div class="section" id="link-a-dataset">
<h3><a class="toc-backref" href="#id56">Link a Dataset</a><a class="headerlink" href="#link-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>Creates a link between a dataset and a dataverse (see the Linked Dataverses + Linked Datasets section of the <a class="reference internal" href="../user/dataverse-management.html"><span class="doc">Dataverse Management</span></a> guide for more information).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key: $API_TOKEN&quot; -X PUT http://$SERVER/api/datasets/$linked-dataset-id/link/$linking-dataverse-alias
</pre></div>
</div>
</div>
<div class="section" id="dataset-locks">
<h3><a class="toc-backref" href="#id57">Dataset Locks</a><a class="headerlink" href="#dataset-locks" title="Permalink to this headline">¶</a></h3>
<p>To check if a dataset is locked:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s2">&quot;$SERVER_URL/api/datasets/</span><span class="si">{database_id}</span><span class="s2">/locks</span>
</pre></div>
</div>
<p>Optionally, you can check if there’s a lock of a specific type on the dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s2">&quot;$SERVER_URL/api/datasets/</span><span class="si">{database_id}</span><span class="s2">/locks?type=</span><span class="si">{lock_type}</span>
</pre></div>
</div>
<p>Currently implemented lock types are <code class="docutils literal notranslate"><span class="pre">Ingest,</span> <span class="pre">Workflow,</span> <span class="pre">InReview,</span> <span class="pre">DcmUpload</span> <span class="pre">and</span> <span class="pre">pidRegister</span></code>.</p>
<p>The API will output the list of locks, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span><span class="s2">&quot;data&quot;</span><span class="p">:</span>
    <span class="p">[</span>
            <span class="p">{</span>
             <span class="s2">&quot;lockType&quot;</span><span class="p">:</span><span class="s2">&quot;Ingest&quot;</span><span class="p">,</span>
             <span class="s2">&quot;date&quot;</span><span class="p">:</span><span class="s2">&quot;Fri Aug 17 15:05:51 EDT 2018&quot;</span><span class="p">,</span>
             <span class="s2">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;dataverseAdmin&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
             <span class="s2">&quot;lockType&quot;</span><span class="p">:</span><span class="s2">&quot;Workflow&quot;</span><span class="p">,</span>
             <span class="s2">&quot;date&quot;</span><span class="p">:</span><span class="s2">&quot;Fri Aug 17 15:02:00 EDT 2018&quot;</span><span class="p">,</span>
             <span class="s2">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;dataverseAdmin&quot;</span>
            <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the dataset is not locked (or if there is no lock of the requested type), the API will return an empty list.</p>
<p>The following API end point will lock a Dataset with a lock of specified type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="p">{</span><span class="n">database_id</span><span class="p">}</span><span class="o">/</span><span class="n">lock</span><span class="o">/</span><span class="p">{</span><span class="n">lock_type</span><span class="p">}</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="s2">&quot;$SERVER_URL/api/datasets/1234/lock/Ingest?key=$ADMIN_API_TOKEN&quot;</span>
<span class="ow">or</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Dataverse-key: $ADMIN_API_TOKEN&quot;</span> <span class="s2">&quot;$SERVER_URL/api/datasets/:persistentId/lock/Ingest?persistentId=$DOI_OR_HANDLE_OF_DATASET&quot;</span>
</pre></div>
</div>
<p>Use the following API to unlock the dataset, by deleting all the locks currently on the dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DELETE</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">datasets</span><span class="o">/</span><span class="p">{</span><span class="n">database_id</span><span class="p">}</span><span class="o">/</span><span class="n">locks</span>
</pre></div>
</div>
<p>Or, to delete a lock of the type specified only:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE /api/datasets/{database_id}/locks?type={lock_type}
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">DELETE</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Dataverse-key: $ADMIN_API_TOKEN&quot;</span> <span class="s2">&quot;$SERVER_URL/api/datasets/1234/locks?type=pidRegister&quot;</span>
</pre></div>
</div>
<p>If the dataset is not locked (or if there is no lock of the specified type), the API will exit with a warning message.</p>
<p>(Note that the API calls above all support both the database id and persistent identifier notation for referencing the dataset)</p>
</div>
</div>
<div class="section" id="files">
<h2><a class="toc-backref" href="#id58">Files</a><a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="adding-files">
<h3><a class="toc-backref" href="#id59">Adding Files</a><a class="headerlink" href="#adding-files" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Files can be added via the native API but the operation is performed on the parent object, which is a dataset. Please see the <a class="reference internal" href="#datasets">Datasets</a> endpoint above for more information.</p>
</div>
</div>
<div class="section" id="accessing-downloading-files">
<h3><a class="toc-backref" href="#id60">Accessing (downloading) files</a><a class="headerlink" href="#accessing-downloading-files" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Access API has its own section in the Guide: <a class="reference internal" href="dataaccess.html"><span class="doc">Data Access API</span></a></p>
</div>
<p><strong>Note</strong> Data Access API calls can now be made using persistent identifiers (in addition to database ids). This is done by passing the constant <code class="docutils literal notranslate"><span class="pre">:persistentId</span></code> where the numeric id of the file is expected, and then passing the actual persistent id as a query parameter with the name <code class="docutils literal notranslate"><span class="pre">persistentId</span></code>.</p>
<blockquote>
<div><p>Example: Getting the file whose DOI is <em>10.5072/FK2/J8SJZB</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/access/datafile/:persistentId/?persistentId=doi:10.5072/FK2/J8SJZB
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="restrict-files">
<h3><a class="toc-backref" href="#id61">Restrict Files</a><a class="headerlink" href="#restrict-files" title="Permalink to this headline">¶</a></h3>
<p>Restrict or unrestrict an existing file where <code class="docutils literal notranslate"><span class="pre">id</span></code> is the database id of the file or <code class="docutils literal notranslate"><span class="pre">pid</span></code> is the persistent id (DOI or Handle) of the file to restrict. Note that some Dataverse installations do not allow the ability to restrict files.</p>
<p>A curl example using an <code class="docutils literal notranslate"><span class="pre">id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key:$API_TOKEN&quot; -X PUT -d true http://$SERVER/api/files/{id}/restrict
</pre></div>
</div>
<p>A curl example using a <code class="docutils literal notranslate"><span class="pre">pid</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key:$API_TOKEN&quot; -X PUT -d true http://$SERVER/api/files/:persistentId/restrict?persistentId={pid}
</pre></div>
</div>
</div>
<div class="section" id="replacing-files">
<h3><a class="toc-backref" href="#id62">Replacing Files</a><a class="headerlink" href="#replacing-files" title="Permalink to this headline">¶</a></h3>
<p>Replace an existing file where <code class="docutils literal notranslate"><span class="pre">id</span></code> is the database id of the file to replace or <code class="docutils literal notranslate"><span class="pre">pid</span></code> is the persistent id (DOI or Handle) of the file. Note that metadata such as description and tags are not carried over from the file being replaced</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -H <span class="s2">&quot;X-Dataverse-key:</span><span class="nv">$API_TOKEN</span><span class="s2">&quot;</span> -X POST -F <span class="s1">&#39;file=@data.tsv&#39;</span> <span class="se">\</span>
-F <span class="s1">&#39;jsonData={&quot;description&quot;:&quot;My description.&quot;,&quot;categories&quot;:[&quot;Data&quot;],&quot;forceReplace&quot;:false}&#39;</span><span class="se">\</span>
<span class="s2">&quot;https://demo.dataverse.org/api/files/</span><span class="nv">$FILE_ID</span><span class="s2">/replace&quot;</span>
</pre></div>
</div>
<p>Example python code to replace a file.  This may be run by changing these parameters in the sample code:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dataverse_server</span></code> - e.g. <a class="reference external" href="https://demo.dataverse.org">https://demo.dataverse.org</a></li>
<li><code class="docutils literal notranslate"><span class="pre">api_key</span></code> - See the top of this document for a description</li>
<li><code class="docutils literal notranslate"><span class="pre">file_id</span></code> - Database id of the file to replace (returned in the GET API for a Dataset)</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>  <span class="c1"># http://docs.python-requests.org/en/master/</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Update params below to run code</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">dataverse_server</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8080&#39;</span> <span class="c1"># no trailing slash</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;some key&#39;</span>
<span class="n">file_id</span> <span class="o">=</span> <span class="mi">1401</span>  <span class="c1"># id of the file to replace</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Prepare replacement &quot;file&quot;</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">file_content</span> <span class="o">=</span> <span class="s1">&#39;content: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;replacement_file.txt&#39;</span><span class="p">,</span> <span class="n">file_content</span><span class="p">)}</span>

<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Using a &quot;jsonData&quot; parameter, add optional description + file tags</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Sunset&#39;</span><span class="p">,</span>
            <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;One&#39;</span><span class="p">,</span> <span class="s1">&#39;More&#39;</span><span class="p">,</span> <span class="s1">&#39;Cup of Coffee&#39;</span><span class="p">])</span>

<span class="c1"># -------------------</span>
<span class="c1"># IMPORTANT: If the mimetype of the replacement file differs</span>
<span class="c1">#   from the origina file, the replace will fail</span>
<span class="c1">#</span>
<span class="c1">#  e.g. if you try to replace a &quot;.csv&quot; with a &quot;.png&quot; or something similar</span>
<span class="c1">#</span>
<span class="c1">#  You can override this with a &quot;forceReplace&quot; parameter</span>
<span class="c1"># -------------------</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;forceReplace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>


<span class="n">params_as_json_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">jsonData</span><span class="o">=</span><span class="n">params_as_json_string</span><span class="p">)</span>

<span class="k">print</span> <span class="s1">&#39;payload&#39;</span><span class="p">,</span> <span class="n">payload</span>
<span class="c1"># --------------------------------------------------</span>
<span class="c1"># Replace file using the id of the file to replace</span>
<span class="c1"># --------------------------------------------------</span>
<span class="n">url_replace</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/api/v1/files/</span><span class="si">%s</span><span class="s1">/replace?key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dataverse_server</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">api_key</span><span class="p">)</span>

<span class="c1"># -------------------</span>
<span class="c1"># Make the request</span>
<span class="c1"># -------------------</span>
<span class="k">print</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">40</span>
<span class="k">print</span> <span class="s1">&#39;making request: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">url_replace</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url_replace</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>

<span class="c1"># -------------------</span>
<span class="c1"># Print the response</span>
<span class="c1"># -------------------</span>
<span class="k">print</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">40</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
<div class="section" id="uningest-a-file">
<h3><a class="toc-backref" href="#id63">Uningest a File</a><a class="headerlink" href="#uningest-a-file" title="Permalink to this headline">¶</a></h3>
<p>Reverse the tabular data ingest process performed on a file where <code class="docutils literal notranslate"><span class="pre">{id}</span></code> is the database id of the file to process. Note that this requires “super user” credentials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/files/{id}/uningest?key={apiKey}
</pre></div>
</div>
</div>
<div class="section" id="reingest-a-file">
<h3><a class="toc-backref" href="#id64">Reingest a File</a><a class="headerlink" href="#reingest-a-file" title="Permalink to this headline">¶</a></h3>
<p>Attempt to ingest an existing datafile as tabular data. This API can be used on a file that was not ingested as tabular back when it was uploaded. For example, a Stata v.14 file that was uploaded before ingest support for Stata 14 was added (in Dataverse v.4.9). It can also be used on a file that failed to ingest due to a bug in the ingest plugin that has since been fixed (hence the name “re-ingest”).</p>
<p>Note that this requires “super user” credentials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/files/{id}/reingest?key={apiKey}
</pre></div>
</div>
<p>(<code class="docutils literal notranslate"><span class="pre">{id}</span></code> is the database id of the file to process)</p>
<p>Also, note that, at present the API cannot be used on a file that’s already ingested as tabular.</p>
</div>
<div class="section" id="provenance">
<h3><a class="toc-backref" href="#id65">Provenance</a><a class="headerlink" href="#provenance" title="Permalink to this headline">¶</a></h3>
<p>Get Provenance JSON for an uploaded file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/files/{id}/prov-json?key=$apiKey
</pre></div>
</div>
<p>Get Provenance Description for an uploaded file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/files/{id}/prov-freeform?key=$apiKey
</pre></div>
</div>
<p>Create/Update Provenance JSON and provide related entity name for an uploaded file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/files/{id}/prov-json?key=$apiKey&amp;entityName=$entity -H &quot;Content-type:application/json&quot; --upload-file $filePath
</pre></div>
</div>
<p>Create/Update Provenance Description for an uploaded file. Requires a JSON file with the description connected to a key named “text”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/files/{id}/prov-freeform?key=$apiKey -H &quot;Content-type:application/json&quot; --upload-file $filePath
</pre></div>
</div>
<p>Delete Provenance JSON for an uploaded file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/files/{id}/prov-json?key=$apiKey
</pre></div>
</div>
</div>
</div>
<div class="section" id="builtin-users">
<h2><a class="toc-backref" href="#id66">Builtin Users</a><a class="headerlink" href="#builtin-users" title="Permalink to this headline">¶</a></h2>
<p>Builtin users are known as “Username/Email and Password” users in the <a class="reference internal" href="../user/account.html"><span class="doc">Account Creation + Management</span></a> of the User Guide. Dataverse stores a password (encrypted, of course) for these users, which differs from “remote” users such as Shibboleth or OAuth users where the password is stored elsewhere. See also “Auth Modes: Local vs. Remote vs. Both” in the <span class="xref std std-doc">/installation/config</span> section of the Installation Guide. It’s a valid configuration of Dataverse to not use builtin users at all.</p>
<div class="section" id="create-a-builtin-user">
<h3><a class="toc-backref" href="#id67">Create a Builtin User</a><a class="headerlink" href="#create-a-builtin-user" title="Permalink to this headline">¶</a></h3>
<p>For security reasons, builtin users cannot be created via API unless the team who runs the Dataverse installation has populated a database setting called <code class="docutils literal notranslate"><span class="pre">BuiltinUsers.KEY</span></code>, which is described under “Securing Your Installation” and “Database Settings” in the <span class="xref std std-doc">/installation/config</span> section of the Installation Guide. You will need to know the value of <code class="docutils literal notranslate"><span class="pre">BuiltinUsers.KEY</span></code> before you can proceed.</p>
<p>To create a builtin user via API, you must first construct a JSON document.  You can download <a class="reference download internal" href="../_downloads/user-add.json" download=""><code class="xref download docutils literal notranslate"><span class="pre">user-add.json</span></code></a> or copy the text below as a starting point and edit as necessary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Lisa&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Simpson&quot;</span><span class="p">,</span>
  <span class="s2">&quot;userName&quot;</span><span class="p">:</span> <span class="s2">&quot;lsimpson&quot;</span><span class="p">,</span>
  <span class="s2">&quot;affiliation&quot;</span><span class="p">:</span> <span class="s2">&quot;Springfield&quot;</span><span class="p">,</span>
  <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="s2">&quot;Student&quot;</span><span class="p">,</span>
  <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;lsimpson@mailinator.com&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Place this <code class="docutils literal notranslate"><span class="pre">user-add.json</span></code> file in your current directory and run the following curl command, substituting variables as necessary. Note that both the password of the new user and the value of <code class="docutils literal notranslate"><span class="pre">BuiltinUsers.KEY</span></code> are passed as query parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">d</span> <span class="nd">@user</span><span class="o">-</span><span class="n">add</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type:application/json&quot;</span> <span class="s2">&quot;$SERVER_URL/api/builtin-users?password=$NEWUSER_PASSWORD&amp;key=$BUILTIN_USERS_KEY&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="roles">
<h2><a class="toc-backref" href="#id68">Roles</a><a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id69">Create a New Role in a Dataverse</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Creates a new role in dataverse object whose Id is <code class="docutils literal notranslate"><span class="pre">dataverseIdtf</span></code> (that’s an id/alias):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/roles?dvo=$dataverseIdtf&amp;key=$apiKey
</pre></div>
</div>
</div>
<div class="section" id="show-role">
<h3><a class="toc-backref" href="#id70">Show Role</a><a class="headerlink" href="#show-role" title="Permalink to this headline">¶</a></h3>
<p>Shows the role with <code class="docutils literal notranslate"><span class="pre">id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/roles/$id
</pre></div>
</div>
</div>
<div class="section" id="delete-role">
<h3><a class="toc-backref" href="#id71">Delete Role</a><a class="headerlink" href="#delete-role" title="Permalink to this headline">¶</a></h3>
<p>Deletes the role with <code class="docutils literal notranslate"><span class="pre">id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/roles/$id
</pre></div>
</div>
</div>
</div>
<div class="section" id="explicit-groups">
<h2><a class="toc-backref" href="#id72">Explicit Groups</a><a class="headerlink" href="#explicit-groups" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-new-explicit-group">
<h3><a class="toc-backref" href="#id73">Create New Explicit Group</a><a class="headerlink" href="#create-new-explicit-group" title="Permalink to this headline">¶</a></h3>
<p>Explicit groups list their members explicitly. These groups are defined in dataverses, which is why their API endpoint is under <code class="docutils literal notranslate"><span class="pre">api/dataverses/$id/</span></code>, where <code class="docutils literal notranslate"><span class="pre">$id</span></code> is the id of the dataverse.</p>
<p>Create a new explicit group under dataverse <code class="docutils literal notranslate"><span class="pre">$id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$server/api/dataverses/$id/groups
</pre></div>
</div>
<p>Data being POSTed is json-formatted description of the group:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Describe the group here&quot;</span><span class="p">,</span>
 <span class="s2">&quot;displayName&quot;</span><span class="p">:</span><span class="s2">&quot;Close Collaborators&quot;</span><span class="p">,</span>
 <span class="s2">&quot;aliasInOwner&quot;</span><span class="p">:</span><span class="s2">&quot;ccs&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="list-explicit-groups-in-a-dataverse">
<h3><a class="toc-backref" href="#id74">List Explicit Groups in a Dataverse</a><a class="headerlink" href="#list-explicit-groups-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>List explicit groups under dataverse <code class="docutils literal notranslate"><span class="pre">$id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$server/api/dataverses/$id/groups
</pre></div>
</div>
</div>
<div class="section" id="show-single-group-in-a-dataverse">
<h3><a class="toc-backref" href="#id75">Show Single Group in a Dataverse</a><a class="headerlink" href="#show-single-group-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Show group <code class="docutils literal notranslate"><span class="pre">$groupAlias</span></code> under dataverse <code class="docutils literal notranslate"><span class="pre">$dv</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$server/api/dataverses/$dv/groups/$groupAlias
</pre></div>
</div>
</div>
<div class="section" id="update-group-in-a-dataverse">
<h3><a class="toc-backref" href="#id76">Update Group in a Dataverse</a><a class="headerlink" href="#update-group-in-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Update group <code class="docutils literal notranslate"><span class="pre">$groupAlias</span></code> under dataverse <code class="docutils literal notranslate"><span class="pre">$dv</span></code>. The request body is the same as the create group one, except that the group alias cannot be changed. Thus, the field <code class="docutils literal notranslate"><span class="pre">aliasInOwner</span></code> is ignored.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$server/api/dataverses/$dv/groups/$groupAlias
</pre></div>
</div>
</div>
<div class="section" id="delete-group-from-a-dataverse">
<h3><a class="toc-backref" href="#id77">Delete Group from a Dataverse</a><a class="headerlink" href="#delete-group-from-a-dataverse" title="Permalink to this headline">¶</a></h3>
<p>Delete group <code class="docutils literal notranslate"><span class="pre">$groupAlias</span></code> under dataverse <code class="docutils literal notranslate"><span class="pre">$dv</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$server/api/dataverses/$dv/groups/$groupAlias
</pre></div>
</div>
</div>
<div class="section" id="add-multiple-role-assignees-to-an-explicit-group">
<h3><a class="toc-backref" href="#id78">Add Multiple Role Assignees to an Explicit Group</a><a class="headerlink" href="#add-multiple-role-assignees-to-an-explicit-group" title="Permalink to this headline">¶</a></h3>
<p>Bulk add role assignees to an explicit group. The request body is a JSON array of role assignee identifiers, such as <code class="docutils literal notranslate"><span class="pre">&#64;admin</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;ip/localhosts</span></code> or <code class="docutils literal notranslate"><span class="pre">:authenticated-users</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$server/api/dataverses/$dv/groups/$groupAlias/roleAssignees
</pre></div>
</div>
</div>
<div class="section" id="add-a-role-assignee-to-an-explicit-group">
<h3><a class="toc-backref" href="#id79">Add a Role Assignee to an Explicit Group</a><a class="headerlink" href="#add-a-role-assignee-to-an-explicit-group" title="Permalink to this headline">¶</a></h3>
<p>Add a single role assignee to a group. Request body is ignored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$server/api/dataverses/$dv/groups/$groupAlias/roleAssignees/$roleAssigneeIdentifier
</pre></div>
</div>
</div>
<div class="section" id="remove-a-role-assignee-from-an-explicit-group">
<h3><a class="toc-backref" href="#id80">Remove a Role Assignee from an Explicit Group</a><a class="headerlink" href="#remove-a-role-assignee-from-an-explicit-group" title="Permalink to this headline">¶</a></h3>
<p>Remove a single role assignee from an explicit group:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$server/api/dataverses/$dv/groups/$groupAlias/roleAssignees/$roleAssigneeIdentifier
</pre></div>
</div>
</div>
</div>
<div class="section" id="shibboleth-groups">
<h2><a class="toc-backref" href="#id81">Shibboleth Groups</a><a class="headerlink" href="#shibboleth-groups" title="Permalink to this headline">¶</a></h2>
<p>Management of Shibboleth groups via API is documented in the <span class="xref std std-doc">/installation/shibboleth</span> section of the Installation Guide.</p>
</div>
<div class="section" id="info">
<h2><a class="toc-backref" href="#id82">Info</a><a class="headerlink" href="#info" title="Permalink to this headline">¶</a></h2>
<div class="section" id="show-dataverse-version-and-build-number">
<h3><a class="toc-backref" href="#id83">Show Dataverse Version and Build Number</a><a class="headerlink" href="#show-dataverse-version-and-build-number" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Get the Dataverse version. The response contains the version and build numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/info/version
</pre></div>
</div>
</div>
<div class="section" id="show-dataverse-server-name">
<h3><a class="toc-backref" href="#id84">Show Dataverse Server Name</a><a class="headerlink" href="#show-dataverse-server-name" title="Permalink to this headline">¶</a></h3>
<p>Get the server name. This is useful when a Dataverse system is composed of multiple Java EE servers behind a load balancer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/info/server
</pre></div>
</div>
</div>
<div class="section" id="show-custom-popup-text-for-publishing-datasets">
<h3><a class="toc-backref" href="#id85">Show Custom Popup Text for Publishing Datasets</a><a class="headerlink" href="#show-custom-popup-text-for-publishing-datasets" title="Permalink to this headline">¶</a></h3>
<p>For now, only the value for the <code class="docutils literal notranslate"><span class="pre">:DatasetPublishPopupCustomText</span></code> setting from the <span class="xref std std-doc">/installation/config</span> section of the Installation Guide is exposed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/info/settings/:DatasetPublishPopupCustomText
</pre></div>
</div>
</div>
<div class="section" id="get-api-terms-of-use-url">
<h3><a class="toc-backref" href="#id86">Get API Terms of Use URL</a><a class="headerlink" href="#get-api-terms-of-use-url" title="Permalink to this headline">¶</a></h3>
<p>Get API Terms of Use. The response contains the text value inserted as API Terms of use which uses the database setting  <code class="docutils literal notranslate"><span class="pre">:ApiTermsOfUse</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/info/apiTermsOfUse
</pre></div>
</div>
</div>
</div>
<div class="section" id="metadata-blocks">
<h2><a class="toc-backref" href="#id87">Metadata Blocks</a><a class="headerlink" href="#metadata-blocks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="show-info-about-all-metadata-blocks">
<h3><a class="toc-backref" href="#id88">Show Info About All Metadata Blocks</a><a class="headerlink" href="#show-info-about-all-metadata-blocks" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Lists brief info about all metadata blocks registered in the system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/metadatablocks
</pre></div>
</div>
</div>
<div class="section" id="show-info-about-single-metadata-block">
<h3><a class="toc-backref" href="#id89">Show Info About Single Metadata Block</a><a class="headerlink" href="#show-info-about-single-metadata-block" title="Permalink to this headline">¶</a></h3>
<p><span class="label label-success pull-right">
  CORS
</span> Return data about the block whose <code class="docutils literal notranslate"><span class="pre">identifier</span></code> is passed. <code class="docutils literal notranslate"><span class="pre">identifier</span></code> can either be the block’s id, or its name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/metadatablocks/$identifier
</pre></div>
</div>
</div>
</div>
<div class="section" id="notifications">
<span id="id2"></span><h2><a class="toc-backref" href="#id90">Notifications</a><a class="headerlink" href="#notifications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-all-notifications-by-user">
<h3><a class="toc-backref" href="#id91">Get All Notifications by User</a><a class="headerlink" href="#get-all-notifications-by-user" title="Permalink to this headline">¶</a></h3>
<p>Each user can get a dump of their notifications by passing in their API token:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H &quot;X-Dataverse-key:$API_TOKEN&quot; $SERVER_URL/api/notifications/all
</pre></div>
</div>
</div>
</div>
<div class="section" id="admin">
<h2><a class="toc-backref" href="#id92">Admin</a><a class="headerlink" href="#admin" title="Permalink to this headline">¶</a></h2>
<p>This is the administrative part of the API. For security reasons, it is absolutely essential that you block it before allowing public access to a Dataverse installation. Blocking can be done using settings. See the <code class="docutils literal notranslate"><span class="pre">post-install-api-block.sh</span></code> script in the <code class="docutils literal notranslate"><span class="pre">scripts/api</span></code> folder for details. See also “Blocking API Endpoints” under “Securing Your Installation” in the <span class="xref std std-doc">/installation/config</span> section of the Installation Guide.</p>
<div class="section" id="list-all-database-settings">
<h3><a class="toc-backref" href="#id93">List All Database Settings</a><a class="headerlink" href="#list-all-database-settings" title="Permalink to this headline">¶</a></h3>
<p>List all settings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/settings
</pre></div>
</div>
</div>
<div class="section" id="configure-database-setting">
<h3><a class="toc-backref" href="#id94">Configure Database Setting</a><a class="headerlink" href="#configure-database-setting" title="Permalink to this headline">¶</a></h3>
<p>Sets setting <code class="docutils literal notranslate"><span class="pre">name</span></code> to the body of the request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/admin/settings/$name
</pre></div>
</div>
</div>
<div class="section" id="get-single-database-setting">
<h3><a class="toc-backref" href="#id95">Get Single Database Setting</a><a class="headerlink" href="#get-single-database-setting" title="Permalink to this headline">¶</a></h3>
<p>Get the setting under <code class="docutils literal notranslate"><span class="pre">name</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/settings/$name
</pre></div>
</div>
</div>
<div class="section" id="delete-database-setting">
<h3><a class="toc-backref" href="#id96">Delete Database Setting</a><a class="headerlink" href="#delete-database-setting" title="Permalink to this headline">¶</a></h3>
<p>Delete the setting under <code class="docutils literal notranslate"><span class="pre">name</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/settings/$name
</pre></div>
</div>
</div>
<div class="section" id="list-authentication-provider-factories">
<h3><a class="toc-backref" href="#id97">List Authentication Provider Factories</a><a class="headerlink" href="#list-authentication-provider-factories" title="Permalink to this headline">¶</a></h3>
<p>List the authentication provider factories. The alias field of these is used while configuring the providers themselves.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/authenticationProviderFactories
</pre></div>
</div>
</div>
<div class="section" id="list-authentication-providers">
<h3><a class="toc-backref" href="#id98">List Authentication Providers</a><a class="headerlink" href="#list-authentication-providers" title="Permalink to this headline">¶</a></h3>
<p>List all the authentication providers in the system (both enabled and disabled):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/authenticationProviders
</pre></div>
</div>
</div>
<div class="section" id="add-authentication-provider">
<h3><a class="toc-backref" href="#id99">Add Authentication Provider</a><a class="headerlink" href="#add-authentication-provider" title="Permalink to this headline">¶</a></h3>
<p>Add new authentication provider. The POST data is in JSON format, similar to the JSON retrieved from this command’s <code class="docutils literal notranslate"><span class="pre">GET</span></code> counterpart.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/admin/authenticationProviders
</pre></div>
</div>
</div>
<div class="section" id="show-authentication-provider">
<h3><a class="toc-backref" href="#id100">Show Authentication Provider</a><a class="headerlink" href="#show-authentication-provider" title="Permalink to this headline">¶</a></h3>
<p>Show data about an authentication provider:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/authenticationProviders/$id
</pre></div>
</div>
</div>
<div class="section" id="enable-or-disable-an-authentication-provider">
<h3><a class="toc-backref" href="#id101">Enable or Disable an Authentication Provider</a><a class="headerlink" href="#enable-or-disable-an-authentication-provider" title="Permalink to this headline">¶</a></h3>
<p>Enable or disable an authentication provider (denoted by <code class="docutils literal notranslate"><span class="pre">id</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/admin/authenticationProviders/$id/enabled
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The former endpoint, ending with <code class="docutils literal notranslate"><span class="pre">:enabled</span></code> (that is, with a colon), is still supported, but deprecated.</p>
</div>
</div>
<div class="section" id="check-if-an-authentication-provider-is-enabled">
<h3><a class="toc-backref" href="#id102">Check If an Authentication Provider is Enabled</a><a class="headerlink" href="#check-if-an-authentication-provider-is-enabled" title="Permalink to this headline">¶</a></h3>
<p>Check whether an authentication proider is enabled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/authenticationProviders/$id/enabled
</pre></div>
</div>
<p>The body of the request should be either <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>. Content type has to be <code class="docutils literal notranslate"><span class="pre">application/json</span></code>, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span><span class="s2">&quot;false&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">authenticationProviders</span><span class="o">/</span><span class="n">echo</span><span class="o">-</span><span class="n">dignified</span><span class="o">/</span><span class="p">:</span><span class="n">enabled</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-an-authentication-provider">
<h3><a class="toc-backref" href="#id103">Delete an Authentication Provider</a><a class="headerlink" href="#delete-an-authentication-provider" title="Permalink to this headline">¶</a></h3>
<p>Deletes an authentication provider from the system. The command succeeds even if there is no such provider, as the postcondition holds: there is no provider by that id after the command returns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/authenticationProviders/$id/
</pre></div>
</div>
</div>
<div class="section" id="list-global-roles">
<h3><a class="toc-backref" href="#id104">List Global Roles</a><a class="headerlink" href="#list-global-roles" title="Permalink to this headline">¶</a></h3>
<p>List all global roles in the system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/roles
</pre></div>
</div>
</div>
<div class="section" id="create-global-role">
<h3><a class="toc-backref" href="#id105">Create Global Role</a><a class="headerlink" href="#create-global-role" title="Permalink to this headline">¶</a></h3>
<p>Creates a global role in the Dataverse installation. The data POSTed are assumed to be a role JSON.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/admin/roles
</pre></div>
</div>
</div>
<div class="section" id="list-users">
<h3><a class="toc-backref" href="#id106">List Users</a><a class="headerlink" href="#list-users" title="Permalink to this headline">¶</a></h3>
<p>List users with the options to search and “page” through results. Only accessible to superusers. Optional parameters:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">searchTerm</span></code> A string that matches the beginning of a user identifier, first name, last name or email address.</li>
<li><code class="docutils literal notranslate"><span class="pre">itemsPerPage</span></code> The number of detailed results to return.  The default is 25.  This number has no limit. e.g. You could set it to 1000 to return 1,000 results</li>
<li><code class="docutils literal notranslate"><span class="pre">selectedPage</span></code> The page of results to return.  The default is 1.</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/list-users
</pre></div>
</div>
<p>Sample output appears below.</p>
<ul class="simple">
<li>When multiple pages of results exist, the <code class="docutils literal notranslate"><span class="pre">selectedPage</span></code> parameters may be specified.</li>
<li>Note, the resulting <code class="docutils literal notranslate"><span class="pre">pagination</span></code> section includes <code class="docutils literal notranslate"><span class="pre">pageCount</span></code>, <code class="docutils literal notranslate"><span class="pre">previousPageNumber</span></code>, <code class="docutils literal notranslate"><span class="pre">nextPageNumber</span></code>, and other variables that may be used to re-create the UI.</li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
    &quot;status&quot;:&quot;OK&quot;,
    &quot;data&quot;:{
        &quot;userCount&quot;:27,
        &quot;selectedPage&quot;:1,
        &quot;pagination&quot;:{
            &quot;isNecessary&quot;:true,
            &quot;numResults&quot;:27,
            &quot;numResultsString&quot;:&quot;27&quot;,
            &quot;docsPerPage&quot;:25,
            &quot;selectedPageNumber&quot;:1,
            &quot;pageCount&quot;:2,
            &quot;hasPreviousPageNumber&quot;:false,
            &quot;previousPageNumber&quot;:1,
            &quot;hasNextPageNumber&quot;:true,
            &quot;nextPageNumber&quot;:2,
            &quot;startResultNumber&quot;:1,
            &quot;endResultNumber&quot;:25,
            &quot;startResultNumberString&quot;:&quot;1&quot;,
            &quot;endResultNumberString&quot;:&quot;25&quot;,
            &quot;remainingResults&quot;:2,
            &quot;numberNextResults&quot;:2,
            &quot;pageNumberList&quot;:[
                1,
                2
            ]
        },
        &quot;bundleStrings&quot;:{
            &quot;userId&quot;:&quot;ID&quot;,
            &quot;userIdentifier&quot;:&quot;Username&quot;,
            &quot;lastName&quot;:&quot;Last Name &quot;,
            &quot;firstName&quot;:&quot;First Name &quot;,
            &quot;email&quot;:&quot;Email&quot;,
            &quot;affiliation&quot;:&quot;Affiliation&quot;,
            &quot;position&quot;:&quot;Position&quot;,
            &quot;isSuperuser&quot;:&quot;Superuser&quot;,
            &quot;authenticationProvider&quot;:&quot;Authentication&quot;,
            &quot;roles&quot;:&quot;Roles&quot;,
            &quot;createdTime&quot;:&quot;Created Time&quot;,
            &quot;lastLoginTime&quot;:&quot;Last Login Time&quot;,
            &quot;lastApiUseTime&quot;:&quot;Last API Use Time&quot;
        },
        &quot;users&quot;:[
            {
                &quot;id&quot;:8,
                &quot;userIdentifier&quot;:&quot;created1&quot;,
                &quot;lastName&quot;:&quot;created1&quot;,
                &quot;firstName&quot;:&quot;created1&quot;,
                &quot;email&quot;:&quot;created1@g.com&quot;,
                &quot;affiliation&quot;:&quot;hello&quot;,
                &quot;isSuperuser&quot;:false,
                &quot;authenticationProvider&quot;:&quot;BuiltinAuthenticationProvider&quot;,
                &quot;roles&quot;:&quot;Curator&quot;,
                &quot;createdTime&quot;:&quot;2017-06-28 10:36:29.444&quot;
            },
            {
                &quot;id&quot;:9,
                &quot;userIdentifier&quot;:&quot;created8&quot;,
                &quot;lastName&quot;:&quot;created8&quot;,
                &quot;firstName&quot;:&quot;created8&quot;,
                &quot;email&quot;:&quot;created8@g.com&quot;,
                &quot;isSuperuser&quot;:false,
                &quot;authenticationProvider&quot;:&quot;BuiltinAuthenticationProvider&quot;,
                &quot;roles&quot;:&quot;Curator&quot;,
                &quot;createdTime&quot;:&quot;2000-01-01 00:00:00.0&quot;
            },
            {
                &quot;id&quot;:1,
                &quot;userIdentifier&quot;:&quot;dataverseAdmin&quot;,
                &quot;lastName&quot;:&quot;Admin&quot;,
                &quot;firstName&quot;:&quot;Dataverse&quot;,
                &quot;email&quot;:&quot;dataverse@mailinator2.com&quot;,
                &quot;affiliation&quot;:&quot;Dataverse.org&quot;,
                &quot;position&quot;:&quot;Admin&quot;,
                &quot;isSuperuser&quot;:true,
                &quot;authenticationProvider&quot;:&quot;BuiltinAuthenticationProvider&quot;,
                &quot;roles&quot;:&quot;Admin, Contributor&quot;,
                &quot;createdTime&quot;:&quot;2000-01-01 00:00:00.0&quot;,
                &quot;lastLoginTime&quot;:&quot;2017-07-03 12:22:35.926&quot;,
                &quot;lastApiUseTime&quot;:&quot;2017-07-03 12:55:57.186&quot;
            }

            // ... 22 more user documents ...
        ]
    }
}
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">“List all users” <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">http://$SERVER/api/admin/authenticatedUsers</span></code> is deprecated, but supported.</p>
</div>
</div>
<div class="section" id="list-single-user">
<h3><a class="toc-backref" href="#id107">List Single User</a><a class="headerlink" href="#list-single-user" title="Permalink to this headline">¶</a></h3>
<p>List user whose <code class="docutils literal notranslate"><span class="pre">identifier</span></code> (without the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> sign) is passed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/authenticatedUsers/$identifier
</pre></div>
</div>
<p>Sample output using “dataverseAdmin” as the <code class="docutils literal notranslate"><span class="pre">identifier</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;authenticationProviderId&quot;</span><span class="p">:</span> <span class="s2">&quot;builtin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;persistentUserId&quot;</span><span class="p">:</span> <span class="s2">&quot;dataverseAdmin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="s2">&quot;Admin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;@dataverseAdmin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataverse Admin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataverse&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Admin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;dataverse@mailinator.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;superuser&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;affiliation&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataverse.org&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Create an authenticateUser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/admin/authenticatedUsers
</pre></div>
</div>
<p>POSTed JSON example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;authenticationProviderId&quot;</span><span class="p">:</span> <span class="s2">&quot;orcid&quot;</span><span class="p">,</span>
  <span class="s2">&quot;persistentUserId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000-0002-3283-0661&quot;</span><span class="p">,</span>
  <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;@pete&quot;</span><span class="p">,</span>
  <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Pete K.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataversky&quot;</span><span class="p">,</span>
  <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;pete@mailinator.com&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="make-user-a-superuser">
<h3><a class="toc-backref" href="#id108">Make User a SuperUser</a><a class="headerlink" href="#make-user-a-superuser" title="Permalink to this headline">¶</a></h3>
<p>Toggles superuser mode on the <code class="docutils literal notranslate"><span class="pre">AuthenticatedUser</span></code> whose <code class="docutils literal notranslate"><span class="pre">identifier</span></code> (without the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> sign) is passed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/admin/superuser/$identifier
</pre></div>
</div>
</div>
<div class="section" id="list-role-assignments-of-a-role-assignee">
<h3><a class="toc-backref" href="#id109">List Role Assignments of a Role Assignee</a><a class="headerlink" href="#list-role-assignments-of-a-role-assignee" title="Permalink to this headline">¶</a></h3>
<p>List all role assignments of a role assignee (i.e. a user or a group):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/assignments/assignees/$identifier
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">identifier</span></code> can contain slashes (e.g. <code class="docutils literal notranslate"><span class="pre">&amp;ip/localhost-users</span></code>).</p>
</div>
<div class="section" id="list-permissions-a-user-has-on-a-dataverse-or-dataset">
<h3><a class="toc-backref" href="#id110">List Permissions a User Has on a Dataverse or Dataset</a><a class="headerlink" href="#list-permissions-a-user-has-on-a-dataverse-or-dataset" title="Permalink to this headline">¶</a></h3>
<p>List permissions a user (based on API Token used) has on a dataverse or dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/permissions/$identifier
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">$identifier</span></code> can be a dataverse alias or database id or a dataset persistent ID or database id.</p>
</div>
<div class="section" id="show-role-assignee">
<h3><a class="toc-backref" href="#id111">Show Role Assignee</a><a class="headerlink" href="#show-role-assignee" title="Permalink to this headline">¶</a></h3>
<p>List a role assignee (i.e. a user or a group):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/assignee/$identifier
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">$identifier</span></code> should start with an <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> if it’s a user. Groups start with <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>. “Built in” users and groups start with <code class="docutils literal notranslate"><span class="pre">:</span></code>. Private URL users start with <code class="docutils literal notranslate"><span class="pre">#</span></code>.</p>
</div>
<div class="section" id="saved-search">
<h3><a class="toc-backref" href="#id112">Saved Search</a><a class="headerlink" href="#saved-search" title="Permalink to this headline">¶</a></h3>
<p>The Saved Search, Linked Dataverses, and Linked Datasets features shipped with Dataverse 4.0, but as a “<a class="reference external" href="https://github.com/IQSS/dataverse/issues/90#issuecomment-86094663">superuser-only</a>” because they are <strong>experimental</strong> (see <a class="reference external" href="https://github.com/IQSS/dataverse/issues/1364">#1364</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/1813">#1813</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/1840">#1840</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/1890">#1890</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/1939">#1939</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/2167">#2167</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/2186">#2186</a>, <a class="reference external" href="https://github.com/IQSS/dataverse/issues/2053">#2053</a>, and <a class="reference external" href="https://github.com/IQSS/dataverse/issues/2543">#2543</a>). The following API endpoints were added to help people with access to the “admin” API make use of these features in their current form. Of particular interest should be the “makelinks” endpoint because it needs to be called periodically (via cron or similar) to find new dataverses and datasets that match the saved search and then link the search results to the dataverse in which the saved search is defined (<a class="reference external" href="https://github.com/IQSS/dataverse/issues/2531">#2531</a> shows an example). There is a known issue (<a class="reference external" href="https://github.com/IQSS/dataverse/issues/1364">#1364</a>) that once a link to a dataverse or dataset is created, it cannot be removed (apart from database manipulation and reindexing) which is why a <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> endpoint for saved searches is neither documented nor functional. The Linked Dataverses feature is <a class="reference external" href="https://github.com/IQSS/dataverse/issues/1852">powered by Saved Search</a> and therefore requires that the “makelinks” endpoint be executed on a periodic basis as well.</p>
<p>List all saved searches.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/savedsearches/list
</pre></div>
</div>
<p>List a saved search by database id.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/savedsearches/$id
</pre></div>
</div>
<p>Execute a saved search by database id and make links to dataverses and datasets that are found. The JSON response indicates which dataverses and datasets were newly linked versus already linked. The <code class="docutils literal notranslate"><span class="pre">debug=true</span></code> query parameter adds to the JSON response extra information about the saved search being executed (which you could also get by listing the saved search).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/admin/savedsearches/makelinks/$id?debug=true
</pre></div>
</div>
<p>Execute all saved searches and make links to dataverses and datasets that are found. <code class="docutils literal notranslate"><span class="pre">debug</span></code> works as described above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/admin/savedsearches/makelinks/all?debug=true
</pre></div>
</div>
</div>
<div class="section" id="dataset-integrity">
<h3><a class="toc-backref" href="#id113">Dataset Integrity</a><a class="headerlink" href="#dataset-integrity" title="Permalink to this headline">¶</a></h3>
<p>Recalculate the UNF value of a dataset version, if it’s missing, by supplying the dataset version database id:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/admin/datasets/integrity/{datasetVersionId}/fixmissingunf
</pre></div>
</div>
</div>
<div class="section" id="workflows">
<h3><a class="toc-backref" href="#id114">Workflows</a><a class="headerlink" href="#workflows" title="Permalink to this headline">¶</a></h3>
<p>List all available workflows in the system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/workflows
</pre></div>
</div>
<p>Get details of a workflow with a given id:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/workflows/$id
</pre></div>
</div>
<p>Add a new workflow. Request body specifies the workflow properties and steps in JSON format.
Sample <code class="docutils literal notranslate"><span class="pre">json</span></code> files are available at <code class="docutils literal notranslate"><span class="pre">scripts/api/data/workflows/</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST http://$SERVER/api/admin/workflows
</pre></div>
</div>
<p>Delete a workflow with a specific id:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/workflows/$id
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the workflow designated by <code class="docutils literal notranslate"><span class="pre">$id</span></code> is a default workflow, a 403 FORBIDDEN response will be returned, and the deletion will be canceled.</p>
</div>
<p>List the default workflow for each trigger type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/workflows/default/
</pre></div>
</div>
<p>Set the default workflow for a given trigger. This workflow is run when a dataset is published. The body of the PUT request is the id of the workflow. Trigger types are <code class="docutils literal notranslate"><span class="pre">PrePublishDataset,</span> <span class="pre">PostPublishDataset</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/admin/workflows/default/$triggerType
</pre></div>
</div>
<p>Get the default workflow for <code class="docutils literal notranslate"><span class="pre">triggerType</span></code>. Returns a JSON representation of the workflow, if present, or 404 NOT FOUND.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/workflows/default/$triggerType
</pre></div>
</div>
<p>Unset the default workflow for <code class="docutils literal notranslate"><span class="pre">triggerType</span></code>. After this call, dataset releases are done with no workflow.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/workflows/default/$triggerType
</pre></div>
</div>
<p>Set the whitelist of IP addresses separated by a semicolon (<code class="docutils literal notranslate"><span class="pre">;</span></code>) allowed to resume workflows. Request body is a list of IP addresses allowed to send “resume workflow” messages to this Dataverse instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PUT http://$SERVER/api/admin/workflows/ip-whitelist
</pre></div>
</div>
<p>Get the whitelist of IP addresses allowed to resume workflows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GET http://$SERVER/api/admin/workflows/ip-whitelist
</pre></div>
</div>
<p>Restore the whitelist of IP addresses allowed to resume workflows to default (localhost only):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/workflows/ip-whitelist
</pre></div>
</div>
</div>
<div class="section" id="metrics">
<h3><a class="toc-backref" href="#id115">Metrics</a><a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h3>
<p>Clear all cached metric results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/clearMetricsCache
</pre></div>
</div>
<p>Clear a specific metric cache. Currently this must match the name of the row in the table, which is named <em>metricName*_*metricYYYYMM</em> (or just <em>metricName</em> if there is no date range for the metric). For example dataversesToMonth_2018-05:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DELETE http://$SERVER/api/admin/clearMetricsCache/$metricDbName
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, UC Regents.<br/>
      Last updated on Oct 07, 2018.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.8.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57484542-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>